const dataBirthday = [
  {
    id: 1,
    name: "Nồng Nàn Tình Yêu",
    url: "https://flowercorner.b-cdn.net/image/cache/catalog/products/B%C3%B3%20Hoa/bo-hoa-hong-do-nong-nan-tinh-yeu.jpg.webp",
    Price: "610,000VND",

  },
  {
    id: 2,
    name: "Nồng Nàn Tình Yêu",
    url: "https://flowercorner.b-cdn.net/image/cache/catalog/products/B%C3%B3%20Hoa/bo-hoa-cam-chuong-quyen-ru.jpg.webp",
    Price: "610,000VND",

  },
  {
    id: 3,
    name: "Nồng Nàn Tình Yêu",
    url: "https://flowercorner.b-cdn.net/image/cache/catalog/products/B%C3%B3%20Hoa/bo-hoa-hong-do-red-rose-real.jpg.webp",
    Price: "610,000VND",

  },
  {
    id: 4,
    name: "Nồng Nàn Tình Yêu",
    url: "https://flowercorner.b-cdn.net/image/cache/catalog/products/B%C3%B3%20Hoa/bo-hoa-hong-do-luon-ben-em.jpg.webp",
    Price: "610,000VND",

  },
];
const dataOpen = [
  {
    id: 1,
    name: "Nồng Nàn Tình Yêu",
    url: "https://flowercorner.b-cdn.net/image/cache/catalog/products/B%C3%B3%20Hoa/bo-hoa-hong-do-nong-nan-tinh-yeu.jpg.webp",
    Price: "610,000VND",

  },
  {
    id: 2,
    name: "Nồng Nàn Tình Yêu",
    url: "https://flowercorner.b-cdn.net/image/cache/catalog/products/B%C3%B3%20Hoa/bo-hoa-cam-chuong-quyen-ru.jpg.webp",
    Price: "610,000VND",

  },
  {
    id: 3,
    name: "Nồng Nàn Tình Yêu",
    url: "https://flowercorner.b-cdn.net/image/cache/catalog/products/B%C3%B3%20Hoa/bo-hoa-hong-do-red-rose-real.jpg.webp",
    Price: "610,000VND",

  },
  {
    id: 4,
    name: "Nồng Nàn Tình Yêu",
    url: "https://flowercorner.b-cdn.net/image/cache/catalog/products/B%C3%B3%20Hoa/bo-hoa-hong-do-luon-ben-em.jpg.webp",
    Price: "610,000VND",

  },
];
const dataTheme = [
  {
    id: 1,
    name: "Nồng Nàn Tình Yêu",
    url: "https://flowercorner.b-cdn.net/image/cache/catalog/products/B%C3%B3%20Hoa/bo-hoa-hong-do-nong-nan-tinh-yeu.jpg.webp",
    Price: "610,000VND",

  },
  {
    id: 2,
    name: "Nồng Nàn Tình Yêu",
    url: "https://flowercorner.b-cdn.net/image/cache/catalog/products/B%C3%B3%20Hoa/bo-hoa-cam-chuong-quyen-ru.jpg.webp",
    Price: "610,000VND",

  },
  {
    id: 3,
    name: "Nồng Nàn Tình Yêu",
    url: "https://flowercorner.b-cdn.net/image/cache/catalog/products/B%C3%B3%20Hoa/bo-hoa-hong-do-red-rose-real.jpg.webp",
    Price: "610,000VND",

  },
  {
    id: 4,
    name: "Nồng Nàn Tình Yêu",
    url: "https://flowercorner.b-cdn.net/image/cache/catalog/products/B%C3%B3%20Hoa/bo-hoa-hong-do-luon-ben-em.jpg.webp",
    Price: "610,000VND",

  },
];
const dataDesign = [
  {
    id: 1,
    name: "Nồng Nàn Tình Yêu",
    url: "https://flowercorner.b-cdn.net/image/cache/catalog/products/B%C3%B3%20Hoa/bo-hoa-hong-do-nong-nan-tinh-yeu.jpg.webp",
    Price: "610,000VND",

  },
  {
    id: 2,
    name: "Nồng Nàn Tình Yêu",
    url: "https://flowercorner.b-cdn.net/image/cache/catalog/products/B%C3%B3%20Hoa/bo-hoa-cam-chuong-quyen-ru.jpg.webp",
    Price: "610,000VND",

  },
  {
    id: 3,
    name: "Nồng Nàn Tình Yêu",
    url: "https://flowercorner.b-cdn.net/image/cache/catalog/products/B%C3%B3%20Hoa/bo-hoa-hong-do-red-rose-real.jpg.webp",
    Price: "610,000VND",

  },
  {
    id: 4,
    name: "Nồng Nàn Tình Yêu",
    url: "https://flowercorner.b-cdn.net/image/cache/catalog/products/B%C3%B3%20Hoa/bo-hoa-hong-do-luon-ben-em.jpg.webp",
    Price: "610,000VND",

  },
];
const dataFresh = [
  {
    id: 1,
    name: "Nồng Nàn Tình Yêu",
    url: "https://flowercorner.b-cdn.net/image/cache/catalog/products/B%C3%B3%20Hoa/bo-hoa-hong-do-nong-nan-tinh-yeu.jpg.webp",
    Price: "610,000VND",

  },
  {
    id: 2,
    name: "Nồng Nàn Tình Yêu",
    url: "https://flowercorner.b-cdn.net/image/cache/catalog/products/B%C3%B3%20Hoa/bo-hoa-cam-chuong-quyen-ru.jpg.webp",
    Price: "610,000VND",

  },
  {
    id: 3,
    name: "Nồng Nàn Tình Yêu",
    url: "https://flowercorner.b-cdn.net/image/cache/catalog/products/B%C3%B3%20Hoa/bo-hoa-hong-do-red-rose-real.jpg.webp",
    Price: "610,000VND",

  },
  {
    id: 4,
    name: "Nồng Nàn Tình Yêu",
    url: "https://flowercorner.b-cdn.net/image/cache/catalog/products/B%C3%B3%20Hoa/bo-hoa-hong-do-luon-ben-em.jpg.webp",
    Price: "610,000VND",

  },
];

function renderProductList(data, selector) {
  var html = data.map(function (product) {
    return `
      <div class="home-list-product-item">
        <img src="${product.url}" alt="${product.name}" />
        <a class="name" href="#">${product.name}</a>
        <div class="price">
          <span class="price-new">${product.Price}</span>
        </div>
        <a class="order-btn" href="#">Đặt hàng</a>
      </div>
    `;
  }).join('');
  $(selector).html(html);
}

$(document).ready(function () {
  renderProductList(dataBirthday, '#product-list-birthday');
  renderProductList(dataOpen, '#product-list-opening');
  renderProductList(dataTheme, '#product-list-theme');
  renderProductList(dataDesign, '#product-list-design');
  renderProductList(dataFresh, '#product-list-fresh');
});

// === PJAX-like loader: load only <main> from target pages and keep header/footer ===
(function () {
  function isSameOrigin(url) {
    try {
      const u = new URL(url, location.href);
      return u.origin === location.origin;
    } catch (e) { return false; }
  }

  async function loadUrl(url, addToHistory = true) {
    try {
      const res = await fetch(url, { credentials: 'same-origin' });
      if (!res.ok) { window.location.href = url; return; }
      const text = await res.text();
      const doc = new DOMParser().parseFromString(text, 'text/html');

      const newMain = doc.querySelector('main');
      if (!newMain) { window.location.href = url; return; }

      const target = document.querySelector('main');
      if (!target) { window.location.href = url; return; }

      // Replace content
      target.innerHTML = newMain.innerHTML;

      // Update title
      const newTitle = doc.querySelector('title');
      if (newTitle) document.title = newTitle.textContent;

      // Re-run page init (if any) to re-bind behaviors
      if (typeof window.pageInit === 'function') {
        try { window.pageInit(); } catch (err) { console.warn('pageInit failed', err); }
      }

      if (addToHistory) history.pushState({ url }, '', url);
    } catch (err) {
      console.error('Ajax load failed', err);
      window.location.href = url;
    }
  }

  // Intercept clicks on links with .ajax-link
  document.addEventListener('click', function (e) {
    const a = e.target.closest('a');
    if (!a) return;
    if (!a.classList.contains('ajax-link')) return;
    const href = a.getAttribute('href');
    if (!href || href.startsWith('#') || href.startsWith('mailto:')) return;
    if (!isSameOrigin(href)) return;
    e.preventDefault();
    loadUrl(href);
  });

  // Handle browser navigation (back/forward)
  window.addEventListener('popstate', function (e) {
    const url = (e.state && e.state.url) ? e.state.url : location.href;
    loadUrl(url, false);
  });

  // Optional stub: place init logic that must run after content swap here.
  window.pageInit = window.pageInit || function () {
    // e.g. re-init carousels, tooltips, event listeners in newly loaded content
    // Example: if you use any jQuery plugins, re-run their init here.
  };
})();
